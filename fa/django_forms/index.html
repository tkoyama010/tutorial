
<!DOCTYPE HTML>
<html lang="fa" dir="rtl">
    <head>
        <meta charset="UTF-8">
        <title>فرم در جنگو · HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.7.5">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-richquotes/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-language-picker/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-sidebar-ad/sidebar-ad.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-codeblock-label/block.css">
                
            
                
                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-sectionx-ex/sectionx.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../whats_next/" />
    
    
    <link rel="prev" href="../extend_your_application/" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
  
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="چیزی برای جستجو بنویسید" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://gitter.im/DjangoGirls/tutorial" target="_blank" class="custom-link">Need help? Talk to us!</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    معرفی
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../installation/">
            
                <a href="../installation/">
            
                    
                    نصب و راه‌اندازی
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../installation/">
            
                <a href="../installation/#command-line">
            
                    
                    خط فرمان
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../installation/">
            
                <a href="../installation/#python">
            
                    
                    پایتون
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../installation/">
            
                <a href="../installation/#code-editor">
            
                    
                    ویرایشگر کد
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../installation/">
            
                <a href="../installation/#virtualenv">
            
                    
                    محیط مجازی
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../installation/">
            
                <a href="../installation/#django">
            
                    
                    جنگو
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../installation/">
            
                <a href="../installation/#git">
            
                    
                    گیت
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../installation/">
            
                <a href="../installation/#github-account">
            
                    
                    GitHub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../installation/">
            
                <a href="../installation/#pythonanywhere-account">
            
                    
                    PythonAnywhere
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../chromebook_setup/">
            
                <a href="../chromebook_setup/">
            
                    
                    نصب و راه اندازی (کروم بوک)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../how_the_internet_works/">
            
                <a href="../how_the_internet_works/">
            
                    
                    اینترنت چگونه کار می‌کند
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../intro_to_command_line/">
            
                <a href="../intro_to_command_line/">
            
                    
                    آشنایی با خط فرمان
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../python_installation/">
            
                <a href="../python_installation/">
            
                    
                    نصب و راه اندازی پایتون
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../code_editor/">
            
                <a href="../code_editor/">
            
                    
                    ویرایشگر کد
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../python_introduction/">
            
                <a href="../python_introduction/">
            
                    
                    آشنایی با پایتون
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../django/">
            
                <a href="../django/">
            
                    
                    جنگو چیست?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../django_installation/">
            
                <a href="../django_installation/">
            
                    
                    نصب و راه اندازی جنگو
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../django_start_project/">
            
                <a href="../django_start_project/">
            
                    
                    اولین پروژه جنگو شما!
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../django_models/">
            
                <a href="../django_models/">
            
                    
                    مدل در جنگو
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../django_admin/">
            
                <a href="../django_admin/">
            
                    
                    پنل مدیریت در جنگو
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../deploy/">
            
                <a href="../deploy/">
            
                    
                    فاز دیپلوی!
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../django_urls/">
            
                <a href="../django_urls/">
            
                    
                    URL ها در جنگو
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../django_views/">
            
                <a href="../django_views/">
            
                    
                    ساخت view در جنگو!
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../html/">
            
                <a href="../html/">
            
                    
                    آشنایی با HTML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../django_orm/">
            
                <a href="../django_orm/">
            
                    
                    ORM در جنگو
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../dynamic_data_in_templates/">
            
                <a href="../dynamic_data_in_templates/">
            
                    
                    داده های پویا در templates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="../django_templates/">
            
                <a href="../django_templates/">
            
                    
                    templates در جنگو
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="../css/">
            
                <a href="../css/">
            
                    
                    CSS - آن را زیبا کنید
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.22" data-path="../template_extending/">
            
                <a href="../template_extending/">
            
                    
                    توسعه template
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23" data-path="../extend_your_application/">
            
                <a href="../extend_your_application/">
            
                    
                    برنامه خود را توسعه دهید
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.24" data-path="./">
            
                <a href="./">
            
                    
                    فرم در جنگو
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.25" data-path="../whats_next/">
            
                <a href="../whats_next/">
            
                    
                    گام بعدی چیست؟
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            انتشار یافته توسط HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
  <div class="sidebar-addition">
      
        <a href="https://www.patreon.com/djangogirls" target="_blank">
      
        <img src="https://djangogirls.org/static/img/global/donate/lagos.jpg" />
      
        </a>
      
      
        <p>💖 Support our work and donate to our project! ✨</p>
      
      
      <a href="https://www.patreon.com/djangogirls" class="btn" target="_blank">
        Donate now!
      </a>
      
  </div>

    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >فرم در جنگو</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="فرم-در-جنگو">فرم در جنگو</h1>
<p>آخرین چیزی که می‌خواهیم در وب سایت مان انجام دهیم ایجاد یک راه خوب برای اضافه کردن و ویرایش پست‌های وبلاگ است. <code>ادمین</code> جنگو خوب است، اما سخت است که آن را زیبا یا سفارشی کنیم. با <code>فرم‌ها</code> ما کنترل کاملی بر روی صفحه خود داریم. تقریباً می‌توانیم هرکاری که بخواهیم انجام دهیم!</p>
<p>ویژگی فرم‌ها در جنگو این است که ما می‌توانیم یکی را از ابتدا تعریف کنیم یا از <code>ModelForm</code>استفاده کنیم که نتیجه فرم را به صورت مدل ذخیره می‌کند.</p>
<p>این دقیقا همان چیزی است که ما می‌خواهیم انجام دهیم: ما یک فرم را برای مدل <code>Post</code> ایجاد خواهیم کرد.</p>
<p>مانند هر بخش مهمی از جنگو، فرم‌ها فایل خود را دارند: <code>forms.py</code>.</p>
<p>ما باید یک فایل با این نام در پوشه <code>blog</code> ایجاد کنیم.</p>
<pre><code>blog
   └── forms.py
</code></pre><p>خوب، اجازه دهید آن را در ویرایشگر کد باز کنیم و خطوط زیر را تایپ کنیم:</p>
<p></p><p class="code-label">blog/forms.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> django <span class="hljs-keyword">import</span> forms

<span class="hljs-keyword">from</span> .models <span class="hljs-keyword">import</span> Post

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostForm</span>(<span class="hljs-params">forms.ModelForm</span>):</span>

    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Meta</span>:</span>
        model = Post
        fields = (<span class="hljs-string">&apos;title&apos;</span>, <span class="hljs-string">&apos;text&apos;</span>,)
</code></pre>
<p>باید در ابتدا فرم‌های جنگو را فراخوانی کنیم (<code>from django import forms</code>) سپس مدل مربوط به <code>Post</code> را نیز فراخوانی کنیم(<code>from .models import Post</code>).</p>
<p><code>PostForm</code>، همانطور که احتمالاً حدس زده اید، نام فرم ما است. ما باید به جنگو بگوییم که این فرم یک نوع <code>ModelForm</code> است (بنابراین جنگو برای ما چند کار جادویی انجام خواهد داد) - <code>forms.ModelForm</code> مسئول انجام این کارها است.</p>
<p>بعد از این، ما <code>class Meta</code> را داریم، جایی که به جنگو می‌گویم که کدام مدل باید برای ایجاد این فرم (<code>model = Post</code>) استفاده شود.</p>
<p>در نهایت می‌توانیم بگوییم که کدام بخش‌ (بخش‌ها) باید در فرم ما باشد. در این سناریو ما تنها <code>title</code> و <code>text</code> را می‌خواهیم نشان دهیم - <code>author</code> باید فردی باشد که در حال حاضر وارد شده است (شما!) و <code>created_date</code> تاریخ ایجاد یک پست جدید است که باید به طور خودکار تنظیم شود، درست است؟</p>
<p>و همین! تمام مواردی که اکنون باید انجام دهیم، استفاده از فرم در یک <em>view</em> و نمایش آن در تمپلیت است.</p>
<p>بنابراین یک بار دیگر یک لینک، یک URL، یک view و یک تمپلیت ایجاد خواهیم کرد.</p>
<h2 id="لینک-به-یک-صفحه-با-فرم">لینک به یک صفحه با فرم</h2>
<p>قبل از آنکه لینک را اضافه کنیم، لازم است آیکونی را به عنوان دکمه برای این لینک اضافه کنیم. برای این دوره آموزشی فایل <a href="https://raw.githubusercontent.com/twbs/icons/main/icons/file-earmark-plus.svg" target="_blank">file-earmark-plus.svg</a> را دانلود کنید و آن را در پوشه <code>blog/templates/blog/icons/</code> ذخیره کنید</p>
<blockquote>
<p>نکته: برای دانلود فایل SVG منو زمینه‌ای مربوط به آن را باز کنید (معمولاً به کمک راست کلیک بر روی آن) و بعد گزینه &quot;Save link as&quot; را انتخاب کنید. در پنجره‌ای که باز می‌شود آدرس محلی که می‌خواهید فایل را ذخیره کنید، مشخص کنید، به پوشه <code>djangogirls</code> که پروژه جنگو شما در آن است بروید و پوشه <code>blog/templates/blog/icons/</code> را پیدا کنید و فایل را در آن ذخیره کنید.</p>
</blockquote>
<p>وقت آن است که فایل <code>blog/templates/blog/base.html</code> را در ویرایشگر متن خود باز کنید. حالا می‌توانیم از فایل آیکون در تمپلیت base به شکل زیر استفاده کنیم. در عنصر <code>div</code> که در بخش <code>header</code> قرار دارد، لینکی قبل از عنصر <code>h1</code> اضافه خواهیم کرد:</p>
<p></p><p class="code-label">blog/templates/blog/base.html</p><p></p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;{% url &apos;post_new&apos; %}&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;top-menu&quot;</span>&gt;</span>
    {% include &apos;./icons/file-earmark-plus.svg&apos; %}
<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</code></pre>
<p>توجه داشته باشید که ما می‌خواهیم نام ویو جدید را <code>post_new</code> بگذاریم. آیتم <a href="https://icons.getbootstrap.com/icons/file-earmark-plus/" target="_blank">SVG icon</a> توسط <a href="https://icons.getbootstrap.com/" target="_blank">Bootstrap Icons</a> ارائه می‌شود و علامتی مانند یک صفحه به همراه یک علامت به اضافه، نشان خواهد داد. ما از یک هدایت‌کننده جنگو یا Django template directive، به اسم <code>include</code> استفاده می‌کنیم. این هدایت‌کننده محتوای یک فایل را به تمپلیت جنگو تزریق می‌کند. مرورگر وب به خوبی می‌تواند این نوع از محتوا را بدون پردازش‌های اضافه، مدیریت کند.</p>
<blockquote>
<p>شما می‌توانید تمام آیکون‌های بوتسترپ را از <a href="https://github.com/twbs/icons/releases/download/v1.1.0/bootstrap-icons-1.1.0.zip" target="_blank">اینجا</a> دانلود کنید. فایل را از حالت زیپ خارج کنید و همه تصاویر را در پوشه‌ای به نام <code>icons</code> در داخل پوشه <code>blog/templates/blog/</code> قرار دهید. به این روش شما می‌توانید به آیکونی مانند <code>pencil-fill.svg</code> از طریق آدرس <code>blog/templates/blog/icons/pencil-fill.svg</code>، دسترسی داشته باشید</p>
</blockquote>
<p>بعد از اصلاح این خط، فایل شما باید به این شکل باشد:</p>
<p></p><p class="code-label">blog/templates/blog/base.html</p><p></p>
<pre><code class="lang-html">{% load static %}
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Django Girls blog<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css&quot;</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">&quot;sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2&quot;</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&apos;//fonts.googleapis.com/css?family=Lobster&amp;subset=latin,latin-ext&apos;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&apos;stylesheet&apos;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&apos;text/css&apos;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;{% static &apos;css/blog.css&apos; %}&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;page-header&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;{% url &apos;post_new&apos; %}&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;top-menu&quot;</span>&gt;</span>
                    {% include &apos;./icons/file-earmark-plus.svg&apos; %}
                <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/&quot;</span>&gt;</span>Django Girls Blog<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content container&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col&quot;</span>&gt;</span>
                    {% block content %}
                    {% endblock %}
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>پس از ذخیره و بازخوانی صفحه <a href="http://127.0.0.1:8000" target="_blank">http://127.0.0.1:8000</a> شما با یک خطای شناخته شده <code>NoReverseMatch</code> مواجه خواهید شد، درست است؟ بسیار عالی!</p>
<h2 id="آدرس-اینترنتی">آدرس اینترنتی</h2>
<p>فایل <code>blog/urls.py</code> را باز کرده و کد زیر را به آن اضافه می‌کنیم:</p>
<p></p><p class="code-label">blog/urls.py</p><p></p>
<pre><code class="lang-python">path(<span class="hljs-string">&apos;post/new/&apos;</span>, views.post_new, name=<span class="hljs-string">&apos;post_new&apos;</span>),
</code></pre>
<p>و در نهایت کد ما بصورت زیر خواهد بود:</p>
<p></p><p class="code-label">blog/urls.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path
<span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> views

urlpatterns = [
    path(<span class="hljs-string">&apos;&apos;</span>, views.post_list, name=<span class="hljs-string">&apos;post_list&apos;</span>),
    path(<span class="hljs-string">&apos;post/&lt;int:pk&gt;/&apos;</span>, views.post_detail, name=<span class="hljs-string">&apos;post_detail&apos;</span>),
    path(<span class="hljs-string">&apos;post/new/&apos;</span>, views.post_new, name=<span class="hljs-string">&apos;post_new&apos;</span>),
]
</code></pre>
<p>از آنجایی که ویوی <code>post_new</code> را پیاده سازی نکرده ایم، هنگامی که سایت را ریفرش کنیم با خطای <code>AttributeError</code> مواجه خواهیم شد. پس باید ویوی مربوطه را نیز بسازیم:</p>
<h2 id="ویو-postnew">ویو post_new</h2>
<p>زمان آن است که فایل <code>blog/views.py</code> را در ویرایشگر کد باز کنید و خطوط زیر را در ردیف <code>from</code> ها اضافه کنید:</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> .forms <span class="hljs-keyword">import</span> PostForm
</code></pre>
<p>و حالا <em>view</em> ما:</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post_new</span>(<span class="hljs-params">request</span>):</span>
    form = PostForm()
    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">&apos;blog/post_edit.html&apos;</span>, {<span class="hljs-string">&apos;form&apos;</span>: form})
</code></pre>
<p>برای ایجاد یک فرم جدید<code>Post</code>، ما باید<code>()PostForm</code> را فراخوانی کنیم و آن را به تمپلیت منتقل کنیم. ما به این <em>view</em> باز خواهیم گشت، اما در حال حاضر، بیایید به سرعت یک تمپلیت برای این فرم ایجاد کنیم.</p>
<h2 id="تمپلیت">تمپلیت</h2>
<p>لازم است یک فایل به نام <code>post_edit.html</code>در پوشه <code>blog/templates/blog</code>بسازیم و آن را در ویرایشگر کد بازکنیم. برای آنکه یک فرم کار کند به چند چیز نیاز داریم:</p>
<ul>
<li>ما باید فرم را نمایش دهیم. مثلاً می‌توانیم این کار را با <code>{{ form.as_p }}</code> انجام دهیم.</li>
<li>خط بالا باید درون تگ فرم HTML پیچیده شود: <code>&lt;form method=&quot;POST&quot;&gt;... &lt;/form&gt;</code>.</li>
<li>ما به یک دکمه <code>ذخیره کردن</code> نیاز داریم. این کار را با یک دکمه HTML انجام می‌دهیم: <code>&lt;button type=&quot;submit&quot;&gt;Save&lt;/button&gt;</code>.</li>
<li>و در نهایت، درست بعد از باز شدن تگ <code>&lt;form ...&gt;</code> باید <code>{% csrf_token %}</code> را اضافه کنیم. نوشتن این عبارت بسیار مهم است، زیرا فرم‌های شما را امن می‌کند! اگر شما این تکه را فراموش کنید، جنگو هنگام تلاش برای ذخیره کردن فرم پیغام خطا می‌دهد:</li>
</ul>
<p><img src="images/csrf2.png" alt="صفحه خطا CSRF"></p>
<p>خوب، بگذار ببینیم HTML در فایل <code>post_edit.html</code> چطور باید باشد:</p>
<p></p><p class="code-label">blog/templates/blog/post_edit.html</p><p></p>
<pre><code class="lang-html">{% extends &apos;blog/base.html&apos; %}

{% block content %}
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>New post<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-form&quot;</span>&gt;</span>{% csrf_token %}
        {{ form.as_p }}
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;save btn btn-default&quot;</span>&gt;</span>Save<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
{% endblock %}
</code></pre>
<p>حالا زمان به روزرسانی پروژه است! بله فرم شما نمایش داده می‌شود!</p>
<p><img src="images/new_form2.png" alt="فرم جدید"></p>
<p>اما یک دقیقه صبر کنید وقتی چیزی را در فیلدهای <code>title</code> و <code>text</code> تایپ کنید و سعی کنید آن را ذخیره کنید، چه اتفاقی خواهد افتاد؟</p>
<p>هیچ چی! ما یک بار دیگر در همان صفحه هستیم و متن ما رفته است... و هیچ پست جدیدی اضافه نشده است. پس چه اتفاقی افتاد؟</p>
<p>جواب این است: هیچ چیز. ما باید در <em>view</em> خودمان کمی کارهای بیشتری انجام دهیم.</p>
<h2 id="ذخیره-فرم">ذخیره فرم</h2>
<p>یکبار دیگر فایل <code>blog/views.py</code> را در ویرایشگر کد باز کنید. در حال حاضر آنچه که در ویو <code>post_new</code> داریم این هاست:</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post_new</span>(<span class="hljs-params">request</span>):</span>
    form = PostForm()
    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">&apos;blog/post_edit.html&apos;</span>, {<span class="hljs-string">&apos;form&apos;</span>: form})
</code></pre>
<p>هنگامی که فرم را ارسال می‌کنیم، ما به همان ویوی قبل باز می‌گردیم، اما این بار ما در <code>request</code> داده‌های بیشتری داریم، به ویژه در <code>request.POST</code> (نامگذاری request.POST هیچ ارتباطی با &quot;پست&quot; وبلاگ ندارد و به معنی آن است که ما در حال ارسال اطلاعات هستیم). به یاد می آورید که چگونه در فایل HTML، تعریف <code>&lt;form&gt;</code> دارای متغیر <code>method=&quot;POST&quot;</code> بود؟ تمام فیلدهای فرم اکنون در <code>request.POST</code> قرار دارند. شما نباید عبارت <code>POST</code> را در اینجا به چیز دیگری تغییر دهید (تنها مقدار معتبر دیگر برای <code>method</code> مقدار <code>GET</code> است، اما الان وقت آن را نداریم تا تفاوت آن‌ها را توضیح دهیم).</p>
<p>بنابراین در <em>view</em>، ما دو موقعیت جداگانه برای رسیدگی داریم: اول اینکه زمانی که ما برای اولین بار به صفحه می‌رویم و یک فرم خالی را می‌خواهیم، و دوم، وقتی با اطلاعات نوشته شده درون فرم، به <em>view</em> برمی‌گردیم. بنابراین ما نیاز به اضافه کردن یک شرط داریم (ما از <code>if</code>برای این منظور استفاده می‌کنیم):</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&quot;POST&quot;</span>:
    [...]
<span class="hljs-keyword">else</span>:
    form = PostForm()
</code></pre>
<p>وقت آن است که نقاط <code>[...]</code> را پر کنید. اگر مقدار <code>method</code> برابر با <code>POST</code> باشد، ما می خواهیم که با اطلاعات درون فرم <code>PostForm</code> را بسازیم، درست است؟ ما این کار را به صورت زیر انجام خواهیم داد:</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python">form = PostForm(request.POST)
</code></pre>
<p>قدم بعدی این است که بررسی کنید که آیا فرم صحیح است (تمام فیلدهای لازم تنظیم شده و مقادیر نادرست وارد نشده است). ما این کار را با <code>form.is_valid()</code> انجام می‌دهیم.</p>
<p>ما بررسی می کنیم که آیا فرم معتبر است و اگر چنین باشد، می توانیم آن را ذخیره کنیم!</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-keyword">if</span> form.is_valid():
    post = form.save(commit=<span class="hljs-literal">False</span>)
    post.author = request.user
    post.published_date = timezone.now()
    post.save()
</code></pre>
<p>اساساً، ما دو چیز در اینجا داریم: فرم را با <code>form.save</code> ذخیره می‌کنیم سپس یک نویسنده برای مطلب تعیین می‌کنیم (از آنجا که فیلد <code>author</code> در فرم موجود نبوده و داشتن نویسنده برای مطلب در <code>PostForm</code>الزامی است). <code>commit=False</code> بدین معنی است که ما نمی‌خواهیم مدل <code>Post</code> را ذخیره کنیم - ما می‌خواهیم ابتدا نویسنده را اضافه کنیم. در بیشتر موارد شما از <code>()form.save</code> بدون <code>commit=False</code> استفاده می‌کنید، اما در این مورد، ما باید آن را استفاده کنیم. <code>()post.save</code> تغییرات (اضافه کردن نویسنده) را اعمال می‌کند و یک پست جدید بلاگ ایجاد می‌شود!</p>
<p>سرانجام، خوب بود اگر می‌توانستیم بلافاصله به صفحه جزییات پست جدید <code>post_detail</code> که هم اکنون ساخته‌ایم برویم، درست است؟ برای این کار ما نیاز به فراخوانی دیگری داریم:</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> redirect
</code></pre>
<p>آن را در ابتدای فایل خود اضافه کنید. و اکنون می‌توان گفت، &quot;به صفحه جزییات پست <code>post_detail</code> برای پست جدید برو&quot;:</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&apos;post_detail&apos;</span>, pk=post.pk)
</code></pre>
<p><code>post_detail</code> نام ویویی است که ما می‌خواهیم به آن برویم. به یاد دارید که این <em>view</em> نیاز به متغیر <code>pk</code> دارد؟ برای فرستادن آن به ویو، از <code>pk=post.pk</code> استفاده می‌کنیم، که در آن <code>post</code> جدیدترین پست وبلاگ است!</p>
<p>خوب، ما خیلی صحبت کرده‌ایم، اما احتمالاً می‌خواهید ببینید که کل <em>view</em> چگونه به نظر می‌رسد، درست است؟</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post_new</span>(<span class="hljs-params">request</span>):</span>
    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&quot;POST&quot;</span>:
        form = PostForm(request.POST)
        <span class="hljs-keyword">if</span> form.is_valid():
            post = form.save(commit=<span class="hljs-literal">False</span>)
            post.author = request.user
            post.published_date = timezone.now()
            post.save()
            <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&apos;post_detail&apos;</span>, pk=post.pk)
    <span class="hljs-keyword">else</span>:
        form = PostForm()
    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">&apos;blog/post_edit.html&apos;</span>, {<span class="hljs-string">&apos;form&apos;</span>: form})
</code></pre>
<p>بیایید ببینیم که آیا کار می‌کند. به صفحه <a href="http://127.0.0.1:8000/post/new/" target="_blank">http://127.0.0.1:8000/post/new/</a> بروید، یک <code>title</code> و یک <code>text</code> اضافه کنید و نتیجه را ببینید! پست جدید وبلاگ اضافه شده است و ما به صفحه <code>post_detail</code> هدایت می‌شویم!</p>
<p>ممکن است متوجه شده باشید که قبل از ذخیره پست، تاریخ انتشار را تنظیم کرده‌ایم. بعدها، ما دکمه <em>publish button</em> را در بخش <strong>Django Girls Tutorial: Extensions</strong> معرفی می‌کنیم.</p>
<p>این عالیه!</p>
<blockquote>
<p>همانطور که اخیراً رابط کاربری ادمین جنگجو را استفاده کردیم، سیستم در حال حاضر فکر می‌کند ما هنوز در سیستم لاگین هستیم. چند موقعیت وجود دارد که می تواند منجر به خروج ما از رابط کاربری مدیریت شود (بسته شدن مرورگر، راه اندازی مجدد دیتابیس و غیره). اگر در هنگام ایجاد یک پست متوجه شدید که خطایی در رابطه با عدم وجود یک کاربر ایجاد شده است، به صفحه مدیریت <a href="http://127.0.0.1:8000/admin" target="_blank">http://127.0.0.1:8000/admin</a> بروید و دوباره وارد شوید. این مسأله به طور موقت حل خواهد شد. یک تکلیف اضافه برای خانه که بعد از بخش اصلی آموزش، انتظار شما را می‌کشد رفع مشکلات امنیتی وبسایت در بخش <strong>Homework: add security to your website!</strong> است.</p>
</blockquote>
<p><img src="images/post_create_error.png" alt="خطا ورود به سیستم"></p>
<h2 id="اعتبارسنجی-فرم">اعتبارسنجی فرم</h2>
<p>حالا به شما نشان می‌دهیم که فرم‌ها در جنگو چقدر جالب هستند. یک پست وبلاگ باید فیلدهای <code>title</code> و <code>text</code> را داشته باشد. در مدل <code>Post</code> ما نگفتیم که این فیلدها (به غیر از <code>published_date</code>) الزامی نیستند، بنابراین، جنگو به طور پیش فرض آن‌ها را الزامی می‌داند.</p>
<p>سعی کنید فرم را بدون <code>title</code> و <code>text</code> ذخیره کنید. حدس بزنید چه اتفاقی خواهد افتاد!</p>
<p><img src="images/form_validation2.png" alt="اعتبارسنجی فرم"></p>
<p>جنگو مواظب است که تمام فیلدهای موجود در فرم ما صحیح پر شده باشند. فوق‌العاده نیست؟</p>
<h2 id="ويرايش-فرم">ويرايش فرم</h2>
<p>حالا ما می‌دانیم که چگونه یک پست جدید اضافه کنیم. اما اگر بخواهیم یک فرم موجود را ویرایش کنیم، چه؟ این کار بسیار شبیه آنچه ما انجام داده‌یم است. بگذارید برخی از چیزهای مهم را سریع بسازیم. (اگر چیزی را درک نمی‌کنید، باید از مربی خود بپرسید یا در فصل‌های قبلی نگاه کنید، زیرا ما قبلاً همه این مراحل را پوشش دادیم.)</p>
<p>ابتدا، اجازه دهید که آیکونی که نمایش دهنده دکمه اصلاح است را ذخیره کنیم. فایل <a href="https://raw.githubusercontent.com/twbs/icons/main/icons/pencil-fill.svg" target="_blank">pencil-fill.svg</a> را دانلود کنید و آن را در آدرس <code>blog/templates/blog/icons/</code> ذخیره کنید.</p>
<p>فایل <code>blog/templates/blog/post_detail.html</code> را در ویرایشگر متن باز کنید و خطوط زیر را به عنصر <code>article</code> اضافه کنید:</p>
<p></p><p class="code-label">blog/templates/blog/post_detail.html</p><p></p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">aside</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;actions&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-default&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;{% url &apos;post_edit&apos; pk=post.pk %}&quot;</span>&gt;</span>
      {% include &apos;./icons/pencil-fill.svg&apos; %}
    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">aside</span>&gt;</span>
</code></pre>
<p>قالب فوق شبیه به این خواهد شد:</p>
<p></p><p class="code-label">blog/templates/blog/post_detail.html</p><p></p>
<pre><code class="lang-html">{% extends &apos;blog/base.html&apos; %}

{% block content %}
    <span class="hljs-tag">&lt;<span class="hljs-name">article</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">aside</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;actions&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-default&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;{% url &apos;post_edit&apos; pk=post.pk %}&quot;</span>&gt;</span>
                {% include &apos;./icons/pencil-fill.svg&apos; %}
            <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">aside</span>&gt;</span>
        {% if post.published_date %}
            <span class="hljs-tag">&lt;<span class="hljs-name">time</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;date&quot;</span>&gt;</span>
                {{ post.published_date }}
            <span class="hljs-tag">&lt;/<span class="hljs-name">time</span>&gt;</span>
        {% endif %}
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{{ post.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ post.text|linebreaksbr }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
{% endblock %}
</code></pre>
<p>فایل <code>blog/urls.py</code> را باز کنید و خط زیر را به آن اضافه کنید:</p>
<p></p><p class="code-label">blog/urls.py</p><p></p>
<pre><code class="lang-python">    path(<span class="hljs-string">&apos;post/&lt;int:pk&gt;/edit/&apos;</span>, views.post_edit, name=<span class="hljs-string">&apos;post_edit&apos;</span>),
</code></pre>
<p>ما از این تمپلیت <code>blog/templates/blog/post_edit.html</code> مجدداً استفاده خواهیم کرد پس تنها قطعه باقی مانده <em>view</em> است.</p>
<p>فایل <code>blog/views.py</code> را باز کنید و خط زیر را به انتهای این فایل اضافه کنید:</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post_edit</span>(<span class="hljs-params">request, pk</span>):</span>
    post = get_object_or_404(Post, pk=pk)
    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&quot;POST&quot;</span>:
        form = PostForm(request.POST, instance=post)
        <span class="hljs-keyword">if</span> form.is_valid():
            post = form.save(commit=<span class="hljs-literal">False</span>)
            post.author = request.user
            post.published_date = timezone.now()
            post.save()
            <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&apos;post_detail&apos;</span>, pk=post.pk)
    <span class="hljs-keyword">else</span>:
        form = PostForm(instance=post)
    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">&apos;blog/post_edit.html&apos;</span>, {<span class="hljs-string">&apos;form&apos;</span>: form})
</code></pre>
<p>این ویو شبیه ویوی <code>post_new</code> ماست، درست است؟ اما نه دقیقاً. در ابتدا ما یک پارامتر <code>pk</code> اضافی از <code>urls</code> ارسال کرده‌ایم. سپس مدل <code>Post</code> را که می‌خواهیم اصلاح کنیم با دستور <code>get_object_or_404(Post, pk=pk)</code> می‌گیریم و بعد از آن یک فرم می‌سازیم و این فرم را به صورت <code>instance</code>ارسال می‌کنیم، هر دو این کارها وقتی اتفاق می‌افتد که فرم را ذخیره می‌کنیم…</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python">form = PostForm(request.POST, instance=post)
</code></pre>
<p>… و هنگامی که یک فرم را به این صورت برای تغییر دادن باز می‌کنیم:</p>
<p></p><p class="code-label">blog/views.py</p><p></p>
<pre><code class="lang-python">form = PostForm(instance=post)
</code></pre>
<p>بسیار خوب، حالا بیایید امتحان کنیم که آیا کار می‌کند! به صفحه <code>post_detail</code> بروید. باید یک کلید edit در گوشه سمت راست بالا باشد:</p>
<p><img src="images/edit_button2.png" alt="کلید Edit"></p>
<p>وقتی بر روی آن کلیک کنید یک فرم که با اطلاعات پست وبلاگی ما پر شده است نشان داده می‌شود:</p>
<p><img src="images/edit_form2.png" alt="فرم Edit"></p>
<p>به راحتی محتوای پست را تغییر دهید و آن را ذخیره کنید!</p>
<p>تبریک! برنامه شما کامل و کامل‌تر می‌شود!</p>
<p>اگر اطلاعات بیشتری در مورد فرم‌ها در جنگو لازم دارید باید مستندات مربوط به آن را در این آدرس بخوانید: <a href="https://docs.djangoproject.com/en/2.2/topics/forms/" target="_blank">https://docs.djangoproject.com/en/2.2/topics/forms/</a></p>
<h2 id="امنیت">امنیت</h2>
<p>ساختن یک پست جدید فقط با یک کلیک، بسیار فوق العاده است! اما همین الان هرکسی که از صفحه شما بازدید می‌کند می‌تواند به راحتی یک پست جدید بسازد و این احتمالاً چیزی نیست که شما بخواهید. حالا بیایید کاری کنیم که این دکمه فقط برای شما نشان داده شود و کس دیگری آن را نبیند.</p>
<p>فایل <code>blog/templates/blog/base.html</code> را در ویرایشگر کد باز کنید بخش <code>div</code> با نام <code>header</code> و تگ a موجود در آن را پیدا کنید. باید چیزی شبیه به این باشد:</p>
<p></p><p class="code-label">blog/templates/blog/base.html</p><p></p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;{% url &apos;post_new&apos; %}&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;top-menu&quot;</span>&gt;</span>
    {% include &apos;./icons/file-earmark-plus.svg&apos; %}
<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</code></pre>
<p>حالا ما می‌خواهیم یک تگ <code>{% if %}</code> دیگر به این اضافه کنیم که باعث خواهد شد این لینک فقط برای کاربری نشان داده شود که به عنوان ادمین وارد شده باشد که در حال حاضر فقط شما هستید! تگ <code>&lt;a&gt;</code> را به شکل زیر تغییر دهید:</p>
<p></p><p class="code-label">blog/templates/blog/base.html</p><p></p>
<pre><code class="lang-html">{% if user.is_authenticated %}
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;{% url &apos;post_new&apos; %}&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;top-menu&quot;</span>&gt;</span>
        {% include &apos;./icons/file-earmark-plus.svg&apos; %}
    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
{% endif %}
</code></pre>
<p>تگ <code>{% if %}</code> باعث خواهد شد که لینک فقط در صورتی به مرورگر ارسال شود که کاربر درخواست کننده صفحه، با حساب کاربری ادمین وارد شده باشد. این کار به طور کامل ساختن پست جدید را محافظت نمی‌کند اما قدم اولیه‌ی خوبی است. مباحث بیشتری از امنیت را در بخش‌های اضافه آموزش پوشش خواهیم داد.</p>
<p>کلید edit را که به صفحه جزییات یک پست اضافه کردیم به یاد دارید؟ حالا همین کار را برای آن صفحه نیز می‌خواهیم انجام دهیم تا دیگران قادر به تغییر محتوای یک پست نباشند.</p>
<p>فایل <code>blog/templates/blog/post_detail.html</code> را باز کنید و خط زیر را پیدا کنید:</p>
<p></p><p class="code-label">blog/templates/blog/post_detail.html</p><p></p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-default&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;{% url &apos;post_edit&apos; pk=post.pk %}&quot;</span>&gt;</span>
    {% include &apos;./icons/pencil-fill.svg&apos; %}
<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</code></pre>
<p>آن را به شکل زیر تغییر دهید:</p>
<p></p><p class="code-label">blog/templates/blog/post_detail.html</p><p></p>
<pre><code class="lang-html">{% if user.is_authenticated %}
     <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-default&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;{% url &apos;post_edit&apos; pk=post.pk %}&quot;</span>&gt;</span>
        {% include &apos;./icons/pencil-fill.svg&apos; %}
     <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
{% endif %}
</code></pre>
<p>از آنجا که احتمالاً هنوز به عنوان ادمین در سیستم لاگین کرده‌اید، اگر صفحه را دوباره بازخوانی کنید، تغییر خاصی را نمی‌بینید. صفحه را در یک مرورگر دیگر یا یک پنجره ناشناس incognito window (در Windows Edge به آن &quot;InPrivate&quot; می‌گویند) بارگذاری کنید. خواهید دید که لینک و آیکون اصلاح پست، نمایش داده نمی‌شود!</p>
<h2 id="یک-چیز-دیگر-زمان-دیپلوی-است">یک چیز دیگر: زمان دیپلوی است!</h2>
<p>بیایید ببینیم آیا همه این تغییرات در PythonAnywhere کار می‌کند. وقت یک دیپلوی کردن دیگر است!</p>
<ul>
<li>ابتدا کد جدید را کامیت کنید و آن را به GitHub بفرستید:</li>
</ul>
<p></p><p class="code-label">خط فرمان</p><p></p>
<pre><code>$ git status
$ git add .
$ git status
$ git commit -m &quot;Added views to create/edit blog post inside the site.&quot;
$ git push
</code></pre><ul>
<li>سپس در کنسول <a href="https://www.pythonanywhere.com/consoles/" target="_blank">PythonAnywhere Bash console</a> تایپ کنید:</li>
</ul>
<p></p><p class="code-label">PythonAnywhere command-line</p><p></p>
<pre><code>$ cd ~/&lt;your-pythonanywhere-domain&gt;.pythonanywhere.com
$ git pull
[...]
</code></pre><p>(یادتان باشد که <code>&lt;your-pythonanywhere-domain&gt;</code> را با زیر دامنه اصلی خود در PythonAnywhere عوض کنید البته بدون آکولادها.)</p>
<ul>
<li>در نهایت به صفحه <a href="https://www.pythonanywhere.com/web_app_setup/" target="_blank">&quot;Web&quot; page</a> بروید (از کلید منو در بالا و سمت راست کنسول استفاده کنید) و کلید <strong>Reload</strong> را بزنید. آدرس وبلاگ خودتان <a href="https://subdomain.pythonanywhere.com" target="_blank">https://subdomain.pythonanywhere.com</a> را باز کنید تا تغییرات را ببینید.</li>
</ul>
<p>به نتیجه رسید! تبریک! :)</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../extend_your_application/" class="navigation navigation-prev " aria-label="Previous page: برنامه خود را توسعه دهید">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../whats_next/" class="navigation navigation-next " aria-label="Next page: گام بعدی چیست؟">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"فرم در جنگو","level":"1.24","depth":1,"next":{"title":"گام بعدی چیست؟","level":"1.25","depth":1,"path":"whats_next/README.md","ref":"whats_next/README.md","articles":[]},"previous":{"title":"برنامه خود را توسعه دهید","level":"1.23","depth":1,"path":"extend_your_application/README.md","ref":"extend_your_application/README.md","articles":[]},"dir":"rtl"},"config":{"plugins":["heading-anchors@1.0.3","ga@1.0.1","richquotes@0.0.9","github@2.0.0","language-picker","sidebar-ad","codeblock-label","sectionx-ex","collapsible-menu"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"collapsible-menu":{},"language-picker":{"grid-columns":3},"github":{"url":"https://github.com/DjangoGirls/tutorial"},"codeblock-label":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sectionx-ex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"richquotes":{"default":false},"sectionx":{"tag":"b"},"heading-anchors":{},"sidebar-ad":{"imageUrl":"https://djangogirls.org/static/img/global/donate/lagos.jpg","url":"https://www.patreon.com/djangogirls","description":"💖 Support our work and donate to our project! ✨","btnText":"Donate now!"},"highlight":{},"ga":{"configuration":"auto","token":"UA-51680040-3"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"py_version":"3.8","py_release":"3.8.6","py_min_version":"3.6","py_min_release":"3.6.8","pa_py_version":"3.8","django_version":"3.2.10"},"language":"fa","links":{"sidebar":{"Need help? Talk to us!":"https://gitter.im/DjangoGirls/tutorial"}},"gitbook":"*"},"file":{"path":"django_forms/README.md","mtime":"2022-11-25T15:13:00.007Z","type":"markdown"},"gitbook":{"version":"3.7.5","time":"2022-11-25T15:13:18.368Z"},"basePath":"..","book":{"language":"fa"}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.2.1/anchor.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-heading-anchors/anchor-style.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-language-picker/plugin.js"></script>
        
    
        
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sectionx-ex/sectionx.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

